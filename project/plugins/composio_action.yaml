name: composio_action
enabled: true
required: true
plugin_only: true
description: >-
  Execute external API actions via Composio (800+ integrations).
  
  USE THIS FOR: Flights, hotels, travel, emails (Gmail), spreadsheets (Google Sheets), 
  messaging (Slack), calendars, CRM, and any external service or API.
  
  This is the PRIMARY plugin for interacting with external services.
  Action IDs follow the pattern: APPNAME_ACTION_NAME (e.g., GMAIL_SEND_EMAIL, COMPOSIO_SEARCH_FLIGHTS).
  OAuth authentication is handled automatically.

examples: |-
  # **CRITICAL: ALWAYS unpack the return tuple! composio_action returns (data, description)**
  # WRONG: result = composio_action(...)  # This assigns tuple, not data!
  # CORRECT: data, desc = composio_action(...)  # Always unpack both values!
  
  # ========== GMAIL ==========
  # Fetch emails - MUST unpack tuple!
  emails, desc = composio_action("GMAIL_FETCH_EMAILS", {"query": "", "max_results": 10, "user_id": "me"})
  for email in emails:  # emails is a list of dicts
      print(email.get('subject', ''))  # Use .get() for safety!
  
  # Send an email
  result, desc = composio_action("GMAIL_SEND_EMAIL", {"recipient_email": "user@example.com", "subject": "Hello", "body": "Message", "user_id": "me"})
  
  # ========== GOOGLE SHEETS ==========
  # Create a new spreadsheet
  new_sheet, desc = composio_action("GOOGLESHEETS_CREATE_GOOGLE_SHEET1", {"title": "My Spreadsheet"})
  
  # Add data to spreadsheet (REQUIRES spreadsheet_id and valueInputOption!)
  result, desc = composio_action("GOOGLESHEETS_SPREADSHEETS_VALUES_APPEND", {"spreadsheet_id": sheet_id, "range": "Sheet1!A1", "values": [["Name", "Email"]], "valueInputOption": "USER_ENTERED"})
  
  # ========== FLIGHTS ==========
  # Search for flights - ALWAYS unpack tuple!
  flights, desc = composio_action("COMPOSIO_SEARCH_FLIGHTS", {"departure_id": "JFK", "arrival_id": "LAX", "outbound_date": "2025-01-15"})
  for flight in flights:  # flights is a list
      print(flight.get('price', 'N/A'))
  
  # **IMPORTANT: Only use VERIFIED action IDs from the list above or search for valid ones.**
  # Do NOT invent action names like OUTLOOK_FETCH_MESSAGES - they may not exist!
  # If unsure, ask user to connect the integration or search for available actions.

parameters:
  - name: action_name
    type: str
    required: true
    description: >-
      Action ID in the format APPNAME_ACTION_NAME (uppercase).
      
      IMPORTANT ACTION IDs:
      - GMAIL_FETCH_EMAILS: Get/read/list emails
      - GMAIL_SEND_EMAIL: Send or forward an email
      - GOOGLESHEETS_CREATE_GOOGLE_SHEET1: Create a NEW spreadsheet
      - GOOGLESHEETS_SPREADSHEETS_VALUES_APPEND: Add rows/data to EXISTING spreadsheet
      - GOOGLESHEETS_CREATE_SPREADSHEET_ROW: Add ONE row to existing spreadsheet (NOT for creating new!)
      
      If the action ID is invalid, an error will be returned with available actions.
      
  - name: params
    type: dict
    required: false
    description: Parameters for the action. Varies by action.
      
  - name: entity_id
    type: str
    required: false
    description: User entity ID for authentication.

returns:
  - name: result
    type: dict
    description: Action result or error info with error_message.
  - name: description
    type: str
    description: Human-readable result description.

configurations:
  entity_id: ""
