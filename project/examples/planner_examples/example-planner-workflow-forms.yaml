enabled: True
rounds:
  - user_query: Create a workflow to collect user feedback with a form and send an email
    state: created
    post_list:
      - message: Create a workflow to collect user feedback with a form and send an email
        send_from: User
        send_to: Planner
        attachment_list:
      - message: Collect user feedback via form and send email notification.
        send_from: Planner
        send_to: CodeInterpreter
        attachment_list:
          - type: plan_reasoning
            content: |-
              The user wants a workflow with form collection and email. I will use form_collect() for collecting structured feedback and composio_action for sending the email.
          - type: init_plan
            content: |-
              1. Collect user feedback using form_collect() with structured fields
              2. Send email with the collected feedback using composio_action <sequentially depends on 1>
              3. Report completion to user <sequentially depends on 2>
          - type: plan
            content: |-
              1. Generate code to collect feedback and send email
              2. Report completion
          - type: current_plan_step
            content: 1. Generate code to collect feedback and send email
          - type: stop
            content: InProcess
      - message: Successfully collected feedback and sent email.
        send_from: CodeInterpreter
        send_to: Planner
        attachment_list:
          - type: thought
            content: I will use form_collect() for collecting structured feedback data and composio_action for sending the email.
          - type: reply_type
            content: python
          - type: reply_content
            content: |-
              # Step 1: Collect feedback using form_collect()
              feedback_data, desc = form_collect("user_feedback", {
                  "title": "User Feedback Form",
                  "description": "Please share your experience with us",
                  "fields": [
                      {"name": "name", "label": "Your Name", "required": True},
                      {"name": "email", "label": "Email Address", "type": "email", "required": True},
                      {"name": "feedback", "label": "Your Feedback", "type": "textarea", "required": True},
                      {"name": "rating", "label": "Rating (1-5)", "type": "number", "required": True}
                  ]
              })
              
              # Step 2: Send email with collected feedback
              email_body = f"Feedback from {feedback_data['name']} ({feedback_data['email']}):\n{feedback_data['feedback']}\nRating: {feedback_data['rating']}/5"
              
              result, desc = composio_action(
                  "GMAIL_SEND_EMAIL",
                  {
                      "to": "admin@example.com",
                      "subject": f"Feedback from {feedback_data['name']}",
                      "body": email_body
                  }
              )
              result
          - type: verification
            content: CORRECT
          - type: code_error
            content: No code error.
          - type: execution_status
            content: SUCCESS
          - type: execution_result
            content: Feedback collected and email sent successfully.
      - message: The workflow has been created! It collects feedback using a form, then sends an email with composio_action.
        send_from: Planner
        send_to: User
        attachment_list:
          - type: plan_reasoning
            content: |-
              The workflow successfully:
              1. Collects form data using form_collect() with structured fields
              2. Sends email using composio_action
          - type: init_plan
            content: |-
              1. Collect user feedback using input() for form fields
              2. Send email with the collected feedback using composio_action <sequentially depends on 1>
              3. Report completion to user <sequentially depends on 2>
          - type: plan
            content: |-
              1. Generate code to collect feedback and send email
              2. Report completion
          - type: current_plan_step
            content: 2. Report completion
          - type: stop
            content: Completed

